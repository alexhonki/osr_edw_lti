'use strict';

module.exports = Syslog;


function Syslog() {
  this.component = resolveComponent();
  this.syslog = require('sap_syslog');
}

Syslog.prototype.log = function (message, callback) {
  var msgType = (message._successful === false) ? this.syslog.AUDIT_ERROR : this.syslog.AUDIT;
  this.syslog.log(this.component, message.toString(), msgType, callback);
};

function resolveComponent() {
  var vcapApp = process.env.VCAP_APPLICATION;
  return (vcapApp) ? JSON.parse(vcapApp).application_name : 'sap-nodejs-audit-logging';
}
